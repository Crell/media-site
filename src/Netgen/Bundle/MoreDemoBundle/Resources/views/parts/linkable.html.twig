{% set url = '#' %}
{% set open_in_new_window = false %}

{% if not ez_is_field_empty( content, 'url' ) %}
    {% set url = ez_field_value( content, 'url' ).link %}

    {% if content.fields.new_window is defined and ez_field_value( content, 'new_window' ).bool %}
        {% set open_in_new_window = true %}
    {% endif %}
{% elseif not ez_is_field_empty( content, 'related_object' ) %}
    {% set related_content_id = ez_field_value( content, 'related_object' ).destinationContentId %}

    {% if related_content_id != content.id %} {# dead loop #}
        {% set url = path( 'ez_urlalias', { 'contentId': related_content_id } ) %}
    {% endif %}
{% endif %}

{% block content %}{% endblock %}
