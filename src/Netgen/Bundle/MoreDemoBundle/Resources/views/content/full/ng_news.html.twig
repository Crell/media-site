{% extends 'NetgenMoreBundle::pagelayout_resolver.html.twig' %}

{% if not content.fields.line_intro.empty %}
    {% set meta_data = { 'description': content.fields.line_intro.value.xml.saveXML()|striptags|trim|truncate( 152 ) } %}
{% elseif not content.fields.full_intro.empty %}
    {% set meta_data = { 'description': content.fields.full_intro.value.xml.saveXML()|striptags|trim|truncate( 152 ) } %}
{% endif %}

{% block content %}
<div class="view-type view-type-{{ viewType }} ng-news {% if not content.fields.css_class.empty %}{{ content.fields.css_class.value.text }}{% endif %} clearfix">

    {% if not content.fields.headline.empty %}
        <h2 class="headline">{{ ng_render_field( content.fields.headline ) }}</h2>
    {% endif %}

    <h1 class="page-header">{{ ng_render_field( content.fields.title ) }}</h1>

    <div class="date">
        <p><small>{{ content.fields.publish_date.value.value|date( 'F j, Y.' ) }}</small></p>
    </div>

    {% if not content.fields.full_intro.empty %}
        <div class="intro">
            {{ ng_render_field( content.fields.full_intro ) }}
        </div>
    {% endif %}

    {% include 'NetgenMoreBundle:parts:social.html.twig' %}

    {% if not content.fields.image.empty or not content.fields.related_multimedia.empty %}
        <div class="images">
            {{ render(
                controller(
                    'ngmore.controller.parts:viewRelatedMultimediaItems', {
                        'locationId': location.id,
                        'includeChildren': true,
                        'contentTypeIdentifiers': ['image', 'ng_video'],
                        'template': 'NetgenMoreDemoBundle:parts:related_multimedia.html.twig'
                    }
                )
            ) }}
        </div>
    {% endif %}

    {% if not content.fields.body.empty %}
        <div class="body">
            {{ ng_render_field( content.fields.body ) }}
        </div>
    {% endif %}

    {% if not content.fields.location.empty %}
        <div class="location">
            {{ ng_render_field( content.fields.location ) }}
        </div>
    {% endif %}

    <div class="related-content">
        {{ render(
            controller(
                'ngmore.controller.parts:viewRelatedItems', {
                    'contentId': content.id,
                    'fieldDefinitionIdentifier': 'related_content',
                    'template': 'NetgenMoreDemoBundle:parts:related_items.html.twig'
                }
            )
        ) }}
    </div>

</div>
{% endblock %}
