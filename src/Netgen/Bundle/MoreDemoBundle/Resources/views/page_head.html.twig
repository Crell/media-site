{% set meta_data = meta_data|default( [] ) %}

{% set config_meta_data = ezpublish.configResolver.getParameter( 'SiteSettings.MetaDataArray' ) %}
{% set meta_data = config_meta_data|merge( meta_data ) %}

{% if content is defined %}
    {% if content.fields.metadata is defined and not ez_is_field_empty( content, 'metadata' ) %}
        {% set content_meta_data = ez_field_value( content, 'metadata' ) %}
        {% for key in config_meta_data|keys %}
            {% if content_meta_data[key] is defined and content_meta_data[key] is not empty %}
                {% set meta_data = meta_data|merge( { ( key ): content_meta_data[key] } ) %}
            {% endif %}
        {% endfor %}
    {% endif %}
{% endif %}

{% if site_title is not defined %}
    {% set site_title = site_name %}

    {% if path_array is not empty %}
        {% if ezpublish.configResolver.getParameter( 'SeoSettings.ShowPathInTitle', 'ngmore' ) in ['false', false] %}
            {% set site_title = path_array[path_array|length - 1].text ~ ' - ' ~ site_title %}
        {% elseif path_array|length > 1 %}
            {% for path_item in path_array %}
                {% if not loop.first %}
                    {% set site_title = path_item.text ~ ' - ' ~ site_title %}
                {% endif %}
            {% endfor %}
        {% endif %}
    {% endif %}

    {% if content_meta_data is defined and content_meta_data.title is defined and content_meta_data.title is not empty %}
        {% set site_title = content_meta_data.title %}
    {% endif %}
{% endif %}

<title>{{ site_title }}</title>

{% for key in config_meta_data|keys %}
    {% if meta_data[key] is defined and meta_data[key] is not empty %}
        <meta name="{{ key }}" content="{{ meta_data[key] }}" />
    {% endif %}
{% endfor %}

{# Prefer chrome frame on IE 8 and lower, or at least as new engine as possible #}
<!--[if lt IE 9 ]>
    <meta http-equiv="X-UA-Compatible" content="IE=8,chrome=1" />
<![endif]-->

<meta name="generator" content="{{ 'ngmore.layout.meta_generator'|trans }}">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

{% include 'NetgenMoreDemoBundle::canonical_link.html.twig' %}

{% include 'NetgenMoreDemoBundle::link.html.twig' %}
